<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Omnifolio – Tools, Not Promises.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

  <!-- Basic SEO -->
  <meta name="description" content="Omnifolio is a neutral, educational investment interface. Tools, not promises – a clean shell for tracking and exploring portfolios." />
  <meta name="robots" content="index, follow" />
  <meta name="theme-color" content="#f8fafc" />

  <style>
    :root{
      --bg:#f8fafc;
      --card:#ffffff;
      --accent:#2563eb;
      --accent-soft:#e0ecff;
      --accent-strong:#1d4ed8;
      --muted:#64748b;
      --text:#0f172a;
      --border:#e2e8f0;
      --danger:#b91c1c;
      --radius:16px;
      --shadow:0 10px 30px rgba(15,23,42,.10);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background:var(--bg);
      color:var(--text);
      display:flex;
      justify-content:center;
      padding:clamp(8px,2vw,18px);
    }
    @media(max-width:640px){
      body{padding:0;background:#eef2f7;}
    }
    .app{
      width:100%;
      max-width:1100px;
      background:linear-gradient(#ffffff,#f9fbff);
      border:1px solid var(--border);
      border-radius:20px;
      box-shadow:var(--shadow);
      display:grid;
      grid-template-columns:1fr;
      overflow:hidden;
    }
    @media(max-width:640px){
      .app{border-radius:0;border-left:none;border-right:none;box-shadow:none;}
    }
    @media(min-width:960px){
      .app{grid-template-columns:270px minmax(0,1fr);}
    }
    /* SIDEBAR */
    .side{
      background:#ffffff;
      border-bottom:1px solid var(--border);
      padding:14px 14px 16px;
    }
    @media(min-width:960px){
      .side{border-right:1px solid var(--border);border-bottom:none;padding:18px 18px 20px;}
    }
    .brand{display:flex;align-items:center;gap:10px;margin-bottom:8px;}
    .badge{
      width:42px;height:42px;border-radius:12px;
      background:#0f172a;color:#ffffff;
      display:flex;align-items:center;justify-content:center;
      font-weight:800;font-size:22px;
      border:1px solid #1f2937;
      box-shadow:0 8px 18px rgba(0,0,0,.12);
    }
    .btext{display:flex;flex-direction:column;}
    .bname{font-weight:800;letter-spacing:.14em;font-size:clamp(16px,3.2vw,20px);}
    .btag{font-size:12px;color:var(--muted);margin-top:1px;}
    .controls{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0 14px;}
    .chip{
      display:inline-flex;align-items:center;gap:8px;
      background:#f1f5f9;border:1px solid var(--border);
      border-radius:999px;padding:7px 12px;
      font-size:12px;color:var(--muted);
      cursor:pointer;
    }
    .toggle{width:36px;height:20px;border-radius:999px;background:#e2e8f0;position:relative;border:1px solid var(--border);}
    .knob{position:absolute;top:2px;left:2px;width:14px;height:14px;background:#94a3b8;border-radius:999px;transition:transform .18s;}
    .chip.active .knob{transform:translateX(16px);background:var(--accent);}
    .nav{display:flex;gap:8px;overflow-x:auto;padding-bottom:6px;}
    @media(min-width:960px){
      .nav{flex-direction:column;overflow:visible;padding-bottom:0;}
    }
    .tab{
      padding:9px 11px;border:1px solid var(--border);background:#ffffff;
      border-radius:12px;font-size:14px;color:var(--muted);
      cursor:pointer;white-space:nowrap;
    }
    .tab.active{
      border-color:var(--accent);background:var(--accent-soft);color:var(--accent-strong);
      box-shadow:0 6px 14px rgba(37,99,235,.18);
    }
    .sidefoot{margin-top:10px;font-size:12px;color:var(--muted);}
    /* MAIN */
    .main{padding:clamp(12px,2vw,22px);}
    .panel{display:none;animation:fade .18s ease-out;}
    .panel.active{display:block;}
    @keyframes fade{from{opacity:0;transform:translateY(3px);}to{opacity:1;transform:translateY(0);}}
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:clamp(12px,2vw,18px);
    }
    .card + .card{margin-top:12px;}
    .ctitle{display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:6px;}
    .h{font-weight:700;font-size:clamp(16px,2.4vw,18px);}
    .ctag{font-size:12px;color:var(--muted);background:#f8fafc;border:1px solid var(--border);border-radius:999px;padding:4px 8px;white-space:nowrap;}
    @media(max-width:520px){
      .ctitle{flex-direction:column;align-items:flex-start;}
      .ctag{margin-top:4px;}
    }
    .p{color:var(--muted);font-size:14px;line-height:1.5;}
    .row{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px;}
    .pill{
      border:1px solid var(--border);border-radius:999px;
      padding:6px 10px;font-size:12px;color:var(--muted);
      background:#ffffff;
    }
    /* FORM + TABLE */
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px;}
    @media(max-width:640px){.grid{grid-template-columns:1fr;}}
    .field{display:flex;flex-direction:column;gap:4px;}
    label{font-size:12px;color:var(--muted);display:flex;align-items:center;gap:4px;}
    input,select,textarea{
      width:100%;border:1px solid var(--border);border-radius:12px;
      background:#f8fafc;padding:9px 11px;font-size:14px;
      color:var(--text);outline:none;
    }
    input:focus,select:focus,textarea:focus{
      border-color:var(--accent);
      box-shadow:0 0 0 1px rgba(37,99,235,.18);
      background:#ffffff;
    }
    textarea{min-height:54px;resize:vertical;}
    .actions{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px;}
    @media(max-width:520px){
      .actions{flex-direction:column;}
      .actions .btn{width:100%;text-align:center;}
    }
    .btn{
      border:1px solid var(--border);border-radius:999px;
      background:#ffffff;color:var(--text);
      padding:9px 15px;font-size:14px;cursor:pointer;
    }
    .btn.primary{background:linear-gradient(135deg,#2563eb,#1d4ed8);border-color:#2563eb;color:#ffffff;}
    .btn.danger{background:#fff1f2;border-color:#fecaca;color:#b91c1c;}
    .hint{font-size:12px;color:var(--muted);}
    .table-wrap{overflow:auto;border:1px solid var(--border);border-radius:12px;background:#ffffff;margin-top:10px;}
    table{width:100%;border-collapse:collapse;font-size:13px;}
    th,td{padding:9px 10px;border-bottom:1px solid var(--border);text-align:left;white-space:nowrap;}
    th{
      background:#f8fafc;color:#475569;
      text-transform:uppercase;font-size:11px;letter-spacing:.06em;
    }
    tr:nth-child(even){background:#fafafa;}
    .del{
      border:1px solid #fecaca;background:#ffffff;
      color:#b91c1c;border-radius:999px;
      padding:4px 9px;font-size:12px;cursor:pointer;
    }
    /* Simple tooltip */
    .tip{position:relative;cursor:help;display:inline-flex;align-items:center;justify-content:center;width:14px;height:14px;border-radius:999px;background:#e2e8f0;color:#475569;font-size:10px;}
    .tiptext{
      position:absolute;z-index:20;bottom:120%;left:50%;transform:translateX(-50%);
      background:#0f172a;color:#e5e7eb;
      padding:6px 8px;border-radius:8px;
      font-size:11px;min-width:160px;max-width:220px;
      opacity:0;pointer-events:none;transition:opacity .15s;
      box-shadow:0 10px 25px rgba(15,23,42,.45);
    }
    .tiptext::after{
      content:"";position:absolute;top:100%;left:50%;transform:translateX(-50%);
      border-width:6px;border-style:solid;
      border-color:#0f172a transparent transparent transparent;
    }
    .tip:hover .tiptext{opacity:1;}
  </style>
</head>
<body>
  <div class="app">
    <aside class="side">
      <div class="brand">
        <div class="badge">Ω</div>
        <div class="btext">
          <div class="bname">OMNIFOLIO</div>
          <div class="btag">Tools, Not Promises.</div>
        </div>
      </div>
      <div class="controls">
        <button id="lite" class="chip">
          <span>Lite mode</span>
          <span class="toggle"><span class="knob"></span></span>
        </button>
      </div>
      <nav class="nav">
        <button class="tab active" data-p="home">Overview</button>
        <button class="tab" data-p="portfolio">Portfolio</button>
        <button class="tab" data-p="allocator">Allocator</button>
        <button class="tab" data-p="news">News</button>
        <button class="tab" data-p="legal">Legal</button>
      </nav>
      <div class="sidefoot">
        Neutral, educational, privacy‑friendly.  
        No ads. No tracking. Just tools.
      </div>
    </aside>

    <main class="main">
      <!-- OVERVIEW -->
      <section class="panel active" data-p="home">
        <div class="card">
          <div class="ctitle">
            <div class="h">Welcome to Omnifolio</div>
            <span class="ctag">Start with the Portfolio tab</span>
          </div>
          <p class="p">
            A calm interface to organise investments. You add positions manually, Omnifolio helps with totals and simple structure.
            For popular crypto tickers we can fetch live EUR prices from CoinGecko.
          </p>
          <div class="row" style="margin-top:10px;">
            <span class="pill">Multi‑asset: crypto, stocks, metals, cash</span>
            <span class="pill">No signals or calls – just structure</span>
            <span class="pill">Local storage only (stays on your device)</span>
          </div>
        </div>
      </section>

      <!-- PORTFOLIO -->
      <section class="panel" data-p="portfolio">
        <div class="card">
          <div class="ctitle">
            <div class="h">Portfolio tracker</div>
            <span class="ctag">Live crypto prices + manual for others</span>
          </div>
          <p class="p">
            Keep it simple: choose the type, enter a ticker (e.g. <b>BTC</b>, <b>ETH</b>, <b>XRP</b>) and the amount you hold.
            For crypto we can auto‑update prices in EUR. For stocks/metals/cash you set the price yourself.
          </p>

          <div class="row" style="margin-top:12px;">
            <button id="refreshPrices" class="btn" type="button">↻ Fetch latest crypto prices</button>
            <span class="hint">
              Works for popular crypto tickers like BTC, ETH, XRP, ADA, SOL, BNB, DOT, AVAX, DOGE, MATIC, TRX, LTC.
            </span>
          </div>

          <form id="form" autocomplete="off">
            <div class="grid">
              <div class="field">
                <label>
                  Type
                  <span class="tip">?
                    <span class="tiptext">
                      <b>Crypto</b> can fetch live prices in EUR.  
                      Other types (stocks, metals, cash) use a price you enter yourself.
                    </span>
                  </span>
                </label>
                <select id="type">
                  <option>Crypto</option>
                  <option>Stock / ETF</option>
                  <option>Metal</option>
                  <option>Cash / Stable</option>
                  <option>Other</option>
                </select>
              </div>
              <div class="field">
                <label>
                  Ticker / Name
                  <span class="tip">?
                    <span class="tiptext">
                      Short code for the asset, e.g. BTC, ETH, XRP, AAPL, GOLD, CASH.
                      For crypto, use common tickers to get live prices.
                    </span>
                  </span>
                </label>
                <input id="ticker" placeholder="e.g. BTC, AAPL, GOLD, Cash" />
              </div>
              <div class="field">
                <label>
                  Amount (units)
                  <span class="tip">?
                    <span class="tiptext">
                      How many units you own.  
                      Example: 0.5 BTC, 10 AAPL, 50g gold, €1000 cash.
                    </span>
                  </span>
                </label>
                <input id="amount" type="number" step="0.00000001" placeholder="e.g. 0.5" />
              </div>
              <div class="field">
                <label>
                  Price per unit (€)
                  <span class="tip">?
                    <span class="tiptext">
                      For crypto this can be filled automatically when you refresh prices.  
                      For everything else, enter the current price yourself.
                    </span>
                  </span>
                </label>
                <input id="price" type="number" step="0.0001" placeholder="auto for crypto, or set manually" />
              </div>
            </div>

            <div class="grid">
              <div class="field">
                <label>
                  Simple tag (optional)
                  <span class="tip">?
                    <span class="tiptext">
                      <b>Core</b> = long‑term holdings you really believe in.  
                      <b>Satellite</b> = smaller supporting positions.  
                      <b>Moonshot</b> = very high risk, small size only.
                    </span>
                  </span>
                </label>
                <select id="tag">
                  <option value="">— none</option>
                  <option>Core (long‑term)</option>
                  <option>Satellite (supporting)</option>
                  <option>Moonshot (high risk)</option>
                </select>
              </div>
              <div class="field">
                <label>Notes (optional)</label>
                <input id="notes" placeholder="Exchange, wallet, DCA, strategy…" />
              </div>
            </div>

            <div class="actions">
              <button class="btn primary" type="submit">Save position</button>
              <button class="btn danger" id="clear" type="button">Clear all</button>
            </div>
          </form>

          <div class="row" style="margin-top:12px;">
            <span class="pill">TOTAL VALUE: <b id="total">€0</b></span>
            <span class="pill">POSITIONS: <b id="count">0</b></span>
          </div>

          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>Asset</th>
                  <th>Type</th>
                  <th>Units</th>
                  <th>Price €</th>
                  <th>Value €</th>
                  <th>Tag</th>
                  <th></th>
                </tr>
              </thead>
              <tbody id="rows">
                <tr><td colspan="7" style="color:#64748b;padding:9px 10px;">No positions yet. Add one above to get started.</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- ALLOCATOR (placeholder shell for future logic) -->
      <section class="panel" data-p="allocator">
        <div class="card">
          <div class="ctitle">
            <div class="h">Allocator (coming later)</div>
            <span class="ctag">Plan → buckets, not signals</span>
          </div>
          <p class="p">
            This area will later become a simple planner: you enter monthly budget, time horizon and risk level.
            Omnifolio suggests high‑level buckets (e.g. 60% core, 30% satellite, 10% moonshot), not specific coins or stocks.
          </p>
        </div>
      </section>

      <!-- NEWS -->
      <section class="panel" data-p="news">
        <div class="card">
          <div class="ctitle">
            <div class="h">News hub (links only)</div>
            <span class="ctag">You pick the sources</span>
          </div>
          <p class="p">
            Omnifolio won’t generate news. The idea is to let you pin links to outlets you trust (for crypto, stocks,
            metals, macro). Read the original, verify information, then come back to your tools.
          </p>
        </div>
      </section>

      <!-- LEGAL -->
      <section class="panel" data-p="legal">
        <div class="card">
          <div class="ctitle">
            <div class="h">Legal & privacy</div>
            <span class="ctag">Education only</span>
          </div>
          <p class="p">
            Omnifolio does <b>not</b> provide financial advice, recommendations or brokerage services. Everything here is
            for education and structure only. Markets are risky – you can lose all money you invest. You are fully responsible
            for your own decisions.
          </p>
          <p class="p" style="margin-top:10px;">
            This prototype stores positions only in your browser using localStorage. No accounts, no tracking code, no third‑party cookies.
          </p>
        </div>
      </section>
    </main>
  </div>

<script>
(() => {
  // Simple tab navigation
  document.querySelectorAll('.tab').forEach(btn => {
    btn.addEventListener('click', () => {
      const target = btn.dataset.p;
      document.querySelectorAll('.tab').forEach(b => b.classList.toggle('active', b===btn));
      document.querySelectorAll('.panel').forEach(p => p.classList.toggle('active', p.dataset.p === target));
    });
  });

  // Lite toggle (for now only visual)
  const liteBtn = document.getElementById('lite');
  liteBtn.addEventListener('click', () => {
    liteBtn.classList.toggle('active');
  });

  // Portfolio state
  const KEY = 'omnifolio_positions_v2';
  let positions = [];
  const rows = document.getElementById('rows');
  const totalEl = document.getElementById('total');
  const countEl = document.getElementById('count');

  function fmt(n){
    return '€' + (n || 0).toLocaleString(undefined,{maximumFractionDigits:2});
  }

  function save(){
    try { localStorage.setItem(KEY, JSON.stringify(positions)); } catch(e){}
  }

  function load(){
    try{
      const raw = localStorage.getItem(KEY);
      if(raw){ positions = JSON.parse(raw) || []; }
    }catch(e){
      positions = [];
    }
  }

  function render(){
    rows.innerHTML = '';
    if(!positions.length){
      const tr = document.createElement('tr');
      const td = document.createElement('td');
      td.colSpan = 7;
      td.style.color = '#64748b';
      td.style.padding = '9px 10px';
      td.textContent = 'No positions yet. Add one above to get started.';
      tr.appendChild(td);
      rows.appendChild(tr);
      totalEl.textContent = '€0';
      countEl.textContent = '0';
      return;
    }
    let total = 0;
    positions.forEach(p => total += p.amount * p.price);
    positions.forEach((p,i) => {
      const tr = document.createElement('tr');
      const value = p.amount * p.price;
      tr.innerHTML = `
        <td>${p.ticker}</td>
        <td>${p.type}</td>
        <td>${p.amount}</td>
        <td>${fmt(p.price)}</td>
        <td>${fmt(value)}</td>
        <td>${p.tag || ''}</td>
        <td><button class="del" data-i="${i}">Remove</button></td>
      `;
      rows.appendChild(tr);
    });
    rows.querySelectorAll('.del').forEach(btn => {
      btn.addEventListener('click', e => {
        const i = Number(e.target.dataset.i);
        positions.splice(i,1);
        save();
        render();
      });
    });
    totalEl.textContent = fmt(total);
    countEl.textContent = String(positions.length);
  }

  load();
  render();

  // Add / update position
  const form = document.getElementById('form');
  form.addEventListener('submit', e => {
    e.preventDefault();
    const type = document.getElementById('type').value;
    const ticker = document.getElementById('ticker').value.trim().toUpperCase();
    const amount = parseFloat(String(document.getElementById('amount').value).replace(',','.')) || 0;
    const priceVal = document.getElementById('price').value;
    const price = parseFloat(String(priceVal).replace(',','.')) || 0;
    const tag = document.getElementById('tag').value;
    const notes = document.getElementById('notes').value || '';

    if(!ticker || amount <= 0){
      alert('Please enter a ticker (e.g. BTC) and an amount greater than 0.');
      return;
    }
    if(type !== 'Crypto' && price <= 0){
      alert('For non‑crypto assets, please enter a price per unit in euros.');
      return;
    }

    const idx = positions.findIndex(p => p.ticker === ticker && p.type === type);
    const pos = { type, ticker, amount, price, tag, notes };
    if(idx > -1) positions[idx] = pos; else positions.push(pos);

    save();
    render();
    form.reset();
  });

  // Clear all
  document.getElementById('clear').addEventListener('click', () => {
    if(confirm('Remove all positions stored in this browser?')){
      positions = [];
      save();
      render();
    }
  });

  // Live prices for crypto using CoinGecko
  const CG_IDS = {
    BTC:'bitcoin', ETH:'ethereum', XRP:'ripple', ADA:'cardano',
    SOL:'solana', BNB:'binancecoin', DOT:'polkadot', AVAX:'avalanche-2',
    DOGE:'dogecoin', MATIC:'matic-network', TRX:'tron', LTC:'litecoin'
  };

  async function fetchCryptoPricesEUR(symbols){
    const ids = symbols.map(s => CG_IDS[s]).filter(Boolean);
    if(!ids.length) return {};
    const url = `https://api.coingecko.com/api/v3/simple/price?ids=${encodeURIComponent(ids.join(','))}&vs_currencies=eur`;
    try{
      const res = await fetch(url,{headers:{'accept':'application/json'}});
      if(!res.ok) throw new Error('HTTP ' + res.status);
      const data = await res.json();
      const map = {};
      symbols.forEach(sym => {
        const id = CG_IDS[sym];
        if(id && data[id] && typeof data[id].eur === 'number'){
          map[sym] = Number(data[id].eur);
        }
      });
      return map;
    }catch(err){
      console.warn('Price fetch failed',err);
      return {};
    }
  }

  document.getElementById('refreshPrices').addEventListener('click', async () => {
    const symbols = Array.from(new Set(positions.filter(p => p.type === 'Crypto').map(p => p.ticker)));
    if(!symbols.length){
      alert('No crypto positions yet. Add at least one with type "Crypto".');
      return;
    }
    const prices = await fetchCryptoPricesEUR(symbols);
    if(!Object.keys(prices).length){
      alert('Could not fetch prices. Try again later or check your connection.');
      return;
    }
    let changed = 0;
    positions = positions.map(p => {
      if(p.type === 'Crypto' && prices[p.ticker]){
        changed++;
        return { ...p, price: prices[p.ticker] };
      }
      return p;
    });
    save();
    render();
    alert('Updated prices for ' + changed + ' crypto position(s).');
  });

})();</script>
</body>
</html>
